<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Employee Profile</title>
    <link rel="stylesheet" href="/gmbm-interface.css" />
    <link rel="stylesheet" href="/profile.css" />
  </head>
  <body>
    <div id="documentModal" class="modal">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <img id="modalImage" src="" alt="Document Preview" />
      </div>
    </div>
    <a href="/view-<%=type%>" class="back-button">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M19 12H5M12 19l-7-7 7-7" />
      </svg>
    </a>
    <div class="container">
      <!-- Back Button -->
      <div class="loading-wave" id="loader">
        <div class="loading-bar"></div>
        <div class="loading-bar"></div>
        <div class="loading-bar"></div>
        <div class="loading-bar"></div>
      </div>
      <div id="content" style="display: none">
        <div class="profile-container">
          <!-- Profile Header -->
          <div class="profile-header">
            <div class="profile-info">
              <div class="dflex">
                <div class="profile-image">
                  <img src="<%= employee.image %>" />
                </div>
                <div class="profile-details">
                  <h1><%= employee.firstname %> <%= employee.lastname %></h1>
                  <p class="employee-id">
                    Employee ID: <%= employee.employeeid %>
                  </p>
                  <div class="quick-stats">
                    <div class="stat">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <path
                          d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"
                        />
                      </svg>
                      <span><%= employee.mobile %></span>
                    </div>
                    <div class="stat">
                      <div class="info-item">
                        <label>Age</label>
                        <span><%= employee.age %> years</span>
                      </div>
                    </div>
                    <div class="stat">
                      <div class="info-item">
                        <label>Gender</label>
                        <span><%= employee.gender %></span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="header">
              <h2>Add Layout</h2>
            </div>

            <div class="card-body">
              <form
                id="layoutForm"
                class="layout-form"
                action="/add-layout?id=<%= employee._id %>&type=<%=type%>"
                method="post"
              >
                <div class="form-grid">
                  <div class="form-group">
                    <label for="layoutName">Layout Name</label>
                    <select id="layoutName" name="layoutName" required>
                      <option value="">Select a layout</option>
                      <option
                        value=" BR’s Madhura Nagar
                      Regadichelika, Kodavaluru"
                      >
                        BR’s Madhura Nagar Regadichelika, Kodavaluru
                      </option>
                      <option
                        value="SLV Estates
                      Mattempadu, Amancherla"
                      >
                        SLV Estates Mattempadu, Amancherla
                      </option>
                      <option
                        value=" SLN Enclave
                      Amancherla"
                      >
                        SLN Enclave Amancherla
                      </option>
                      <option
                        value=" Urbana
                      Golagamudi Road, Nellore"
                      >
                        Urbana Golagamudi Road, Nellore
                      </option>
                      <option
                        value="GRR Prime City
                      Near Eenadu Offfice, Chamudugunta"
                      >
                        GRR Prime City Near Eenadu Offfice, Chamudugunta
                      </option>
                      <option
                        value=" DR Fortune Heights
                        Kalivelapalem Road, Dhanalakshmi puram"
                      >
                        DR Fortune Heights Kalivelapalem Road, Dhanalakshmi
                        puram
                      </option>
                      <option
                        value="Vardhan Valencia
                      
                        Beside Amaravathi Hotel, Gudur"
                      >
                        Vardhan Valencia Beside Amaravathi Hotel, Gudur
                      </option>
                      <option
                        value="Vaarahi Apartments
                        
                        Tada"
                      >
                        Vaarahi Apartments Tada
                      </option>
                      <option
                        value="Sri Krishna Brundavanam
                        Gangavaram"
                      >
                        Sri Krishna Brundavanam Gangavaram
                      </option>
                      <option
                        value=" SGP Blooming City
                        Bombay Highway, Damaramadugu"
                      >
                        SGP Blooming City Bombay Highway, Damaramadugu
                      </option>
                      <option
                        value="Iskon Brundavanam
                        Gangavaram"
                      >
                        Iskon Brundavanam Gangavaram
                      </option>
                      <option
                        value=" Sri Balaji Sunrise City
                        Podalakur, Sangam Road"
                      >
                        Sri Balaji Sunrise City Podalakur, Sangam Road
                      </option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="plotsSold">Plots Sold</label>
                    <input
                      type="number"
                      name="plotsSold"
                      id="plotsSold"
                      min="0"
                      required
                    />
                  </div>
                </div>
                <div class="form-actions">
                  <button type="submit" class="btn-primary">Save Layout</button>
                </div>
              </form>
            </div>

            <div class="header">
              <h2>Layout Management</h2>
            </div>
            <% employee.layouts.forEach(function(lay) { %>
            <div class="quick-stats">
              <div class="stat">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M12 20V10" />
                  <path d="M18 20V4" />
                  <path d="M6 20v-4" />
                </svg>
                <span>Layout name ---<%=lay.name%></span>
              </div>
              <div class="stat">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                  <polyline points="9 22 9 12 15 12 15 22" />
                </svg>
                <span>Plots Sold ---<%=lay.plotsSold%></span>
              </div>
            </div>
            <% }); %>
          </div>

          <!-- Profile Content -->
          <div class="profile-content">
            <!-- disp bms -->

            <!-- Action Buttons -->
            <div class="action-buttons">
              <a
                href="/edit/<%= employee.id %>?type=<%=type%>"
                class="btn-edit"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"
                  />
                </svg>
                Edit Profile
              </a>
              <form action="/delete-<%=type%>" method="post">
                <input type="hidden" name="id" value="<%= employee.id %>" />
                <button type="submit" class="delete-btn">Delete User</button>
              </form>
              <% if (type==="gm") { %>
              <button class="btn btn-assign">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                  <circle cx="9" cy="7" r="4" />
                  <line x1="19" y1="8" x2="19" y2="14" />
                  <line x1="22" y1="11" x2="16" y2="11" />
                </svg>
                <input
                  type="hidden"
                  name="empid"
                  class="empid"
                  value="<%= employee.employeeid %>"
                />

                Show Associates
              </button>
              <% } %>
            </div>
          </div>
        </div>

        <div class="container documents-section">
          <div class="documents-container">
            <h2 class="h2">Uploaded Documents</h2>
            <% if (employee.uploaddocs && employee.uploaddocs.length > 0) { %>
            <div class="documents-grid">
              <% employee.uploaddocs.forEach(function(doc) { %>
              <div class="document-card">
                <div class="document-preview">
                  <img src="<%= doc.doc %>" alt="<%= doc.name %>" />
                </div>
                <div class="document-info">
                  <span class="document-date"
                    ><%= new Date(doc.uploadDate).toLocaleDateString() %></span
                  >
                </div>
              </div>
              <% }); %>
            </div>
            <% } else { %>
            <div class="no-documents">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="48"
                height="48"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"
                ></path>
                <polyline points="13 2 13 9 20 9"></polyline>
              </svg>
              <p>No documents uploaded</p>
            </div>
            <% } %>
          </div>
        </div>

        <% if (type==="gm") { %>
        <div class="main table-container" id="table"></div>

        <div>
          <% if ((employee.associates && employee.associates.length) > 0) { %>
          <div>
            <% employee.associates.forEach(function(associate) { %>
            <input
              type="hidden"
              class="associate"
              value="<%= associate.associate %>"
            />
            <% }); %>
          </div>
          <% }else{ %>
          <div>
            <p>No associates found</p>
          </div>
          <% } %>
        </div>
        <% } %>
      </div>
    </div>
    <script src="/display.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const loader = document.getElementById("loader");
        const content = document.getElementById("content");

        // Simulate data fetching with a timeout
        setTimeout(() => {
          // Hide the loader and show the content
          loader.style.display = "none";
          content.style.display = "block";
        }, 1000); // Adjust the timeout duration as needed
      });

      const ass = document.querySelector(".btn-assign");
      const table = document.querySelector("#table");
      ass.addEventListener("click", () => {
        table.scrollIntoView({ behavior: "smooth" });
      });
    </script>
  </body>
</html>
